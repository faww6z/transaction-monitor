<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Alert Detail</title>
    <style>
        body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; padding: 24px; max-width: 900px; }
        a { text-decoration: none; }
        .card { border: 1px solid #eee; border-radius: 12px; padding: 16px; margin: 12px 0; }
        .row { display: flex; gap: 16px; flex-wrap: wrap; }
        .kv { min-width: 260px; }
        .k { color: #666; font-size: 12px; }
        .v { font-size: 16px; margin-top: 4px; }
        select, textarea, button { font-size: 14px; padding: 8px; }
        textarea { width: 100%; min-height: 90px; }
        button { cursor: pointer; }
    </style>
</head>
<body>
<p><a href="/alerts">‚Üê Back to Alerts</a></p>

<h1>Alert <span th:text="${alert.id}">1</span></h1>

<div class="card">
    <div class="row">
        <div class="kv">
            <div class="k">Status</div>
            <div class="v" th:text="${alert.status}">OPEN</div>
        </div>
        <div class="kv">
            <div class="k">Created</div>
            <div class="v" th:text="${#temporals.format(alert.createdAt, 'yyyy-MM-dd HH:mm:ss')}">time</div>
        </div>
        <div class="kv">
            <div class="k">Risk Level</div>
            <div class="v" th:text="${alert.riskScore.riskLevel}">HIGH</div>
        </div>
        <div class="kv">
            <div class="k">Score</div>
            <div class="v" th:text="${alert.riskScore.score}">100</div>
        </div>
    </div>
    <div style="margin-top:10px;">
        <div class="k">Triggered Rules</div>
        <div class="v">
  <span th:each="r : ${#strings.arraySplit(alert.riskScore.triggeredRules, ',')}"
        class="pill"
        th:text="${r}"
        style="margin-right:6px; margin-bottom:4px; display:inline-block;">
    RULE
  </span>
        </div>
    </div>
</div>

<div class="card">
    <h3>Transaction</h3>
    <div class="row">
        <div class="kv"><div class="k">Type</div><div class="v" th:text="${alert.transaction.type}">CASH_OUT</div></div>
        <div class="kv"><div class="k">Amount</div><div class="v" th:text="${alert.transaction.amount}">15000</div></div>
        <div class="kv"><div class="k">Old Balance (Orig)</div><div class="v" th:text="${alert.transaction.oldBalanceOrig}">20000</div></div>
        <div class="kv"><div class="k">New Balance (Orig)</div><div class="v" th:text="${alert.transaction.newBalanceOrig}">3000</div></div>
        <div class="kv"><div class="k">Old Balance (Dest)</div><div class="v" th:text="${alert.transaction.oldBalanceDest}">100</div></div>
        <div class="kv"><div class="k">New Balance (Dest)</div><div class="v" th:text="${alert.transaction.newBalanceDest}">15100</div></div>
    </div>
</div>

<div class="card">
    <h3>Update Status</h3>
    <form th:action="@{'/alerts/' + ${alert.id} + '/status'}" method="post">
        <div style="margin: 8px 0;">
            <label class="k">New Status</label><br/>
            <select name="status">
                <option th:each="s : ${statuses}" th:value="${s}" th:text="${s}" th:selected="${s} == ${alert.status}"></option>
            </select>
        </div>

        <div style="margin: 8px 0;">
            <label class="k">Investigator Note</label><br/>
            <textarea name="investigatorNote" th:text="${alert.investigatorNote}"></textarea>
        </div>

        <button type="submit">Save</button>
    </form>
</div>
</body>
</html>
